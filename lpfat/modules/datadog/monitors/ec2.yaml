ec2cpu_high:
  name: aws.ec2.cpuutilization - CPU High - {host}
  priority: 3
  trigger: "> 85"
  period: 30m
  spaceagg: max
  timeagg: avg
  message: Average CPU is above 85% for 30 minutes.
  metric_math: a
  metric:
    a: aws.ec2.cpuutilization
  multi: host
  filters: leaseplan_workload:lpworkload,leaseplan_environment:lpenv,leaseplan_project:lpproject
  optional_settings:
    evaluation_delay: 900
    require_full_window: false
    thresholds: 
      critical: 85

ec2cpu_very_high:
  name: aws.ec2.cpuutilization - CPU Very High - {host}
  priority: 3
  trigger: "> 95"
  period: 5m
  spaceagg: max
  timeagg: min
  message: Maximum CPU is above 95% for 5 minutes.
  metric_math: a
  metric:
    a: aws.ec2.cpuutilization
  multi: host
  filters: leaseplan_workload:lpworkload,leaseplan_environment:lpenv,leaseplan_project:lpproject
  optional_settings:
    evaluation_delay: 900
    require_full_window: false
    thresholds: 
      critical: 95

ec2memory_high:
  name: Host Memory High - {host}
  priority: 3
  trigger: ">85"
  period: 30m
  spaceagg: max
  timeagg: avg
  message: Average memory usage is above 85% for 30 minutes.
  metric_math: 100 * a / b
  metric:
    a: system.mem.usable
    b: system.mem.total
  multi: host
  filters: leaseplan_workload:lpworkload,leaseplan_environment:lpenv,leaseplan_project:lpproject

ec2memory_very_high:
  name: Host Memory Very High - {host}
  priority: 3
  trigger: ">95"
  period: 5m
  spaceagg: max
  timeagg: min
  message: Maximum memory usage is above 95% for 5 minutes.
  metric_math: 100 * a / b
  metric:
    a: system.mem.usable
    b: system.mem.total
  multi: host
  filters: leaseplan_workload:lpworkload,leaseplan_environment:lpenv,leaseplan_project:lpproject

ec2disk_high:
  name: Host Disk High - {host}
  priority: 3
  trigger: ">80"
  period: 90m
  spaceagg: max
  timeagg: min
  message: Disk usage is above 80% for 90 minutes.
  metric_math: 100 * a / b
  metric:
    a: system.disk.used
    b: system.disk.total
  multi: host,device
  filters: leaseplan_workload:lpworkload,leaseplan_environment:lpenv,leaseplan_project:lpproject

ec2disk_very_high:
  name: Host Disk Very High - {host}
  priority: 3
  trigger: ">95"
  period: 15m
  spaceagg: max
  timeagg: min
  message: Disk usage is above 95% for 15 minutes.
  metric_math: 100 * a / b
  metric:
    a: system.disk.used
    b: system.disk.total
  multi: host,device
  filters: leaseplan_workload:lpworkload,leaseplan_environment:lpenv,leaseplan_project:lpproject

ec2_status_check:
  name: aws.ec2.status_check_failed - EC2 Status Check Failed - {host}
  priority: 3
  trigger: ">0"
  period: 5m
  spaceagg: max
  timeagg: max
  message: EC2 status check has failed.
  metric_math: a
  metric:
    a: aws.ec2.status_check_failed
  multi: host
  filters: leaseplan_workload:lpworkload,leaseplan_environment:lpenv,leaseplan_project:lpproject
